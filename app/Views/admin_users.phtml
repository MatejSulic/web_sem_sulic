<div class="container mt-4">
    <h2>Správa uživatelů (Admin)</h2>

    <?php if (isset($msg) && $msg == 'updated'): ?>
        <div class="alert alert-success">Role byla úspěšně změněna.</div>
    <?php endif; ?>
    <?php if (isset($msg) && $msg == 'error_self'): ?>
        <div class="alert alert-danger">Nemůžete změnit roli sám sobě!</div>
    <?php endif; ?>

    <table class="table table-bordered table-hover">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>Uživatelské jméno</th>
                <th>Email</th>
                <th>Aktuální role</th>
                <th>Změnit roli</th>
            </tr>
        </thead>
        <tbody>
            <?php foreach ($users as $u): ?>
            <tr>
                <td><?= $u->id ?></td>
                <td><?= htmlspecialchars($u->username) ?></td>
                <td><?= htmlspecialchars($u->email) ?></td>
                <td>
                    <span class="badge bg-secondary"><?= $u->role ?></span>
                </td>
                <td>
                    <form action="index.php?page=admin-change-role" method="post" class="d-flex gap-2">
                        <input type="hidden" name="user_id" value="<?= $u->id ?>">
                        
                        <select name="new_role" class="form-select form-select-sm" style="width: auto;">
                            <option value="author" <?= $u->role == 'author' ? 'selected' : '' ?>>Author</option>
                            <option value="reviewer" <?= $u->role == 'reviewer' ? 'selected' : '' ?>>Reviewer</option>
                            <option value="admin" <?= $u->role == 'admin' ? 'selected' : '' ?>>Admin</option>
                        </select>
                        
                        <button type="submit" class="btn btn-sm btn-primary">Uložit</button>
                    </form>
                </td>
            </tr>
            <?php endforeach; ?>
        </tbody>
    </table>
</div>